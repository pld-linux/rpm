diff -ruN rpm-5.4.15.orig/macros/macros rpm-5.4.15/macros/macros
--- rpm-5.4.15.orig/macros/macros	2014-08-17 14:02:20.000000000 +0200
+++ rpm-5.4.15/macros/macros	2018-09-24 15:46:44.323052200 +0200
@@ -519,7 +519,7 @@
 #	signing and verification.
 #
 %__gpg_check_password_cmd	%{__gpg} \
-	gpg --batch --no-verbose --passphrase-fd 3 -u "%{_gpg_name}" -so -
+	gpg --batch --pinentry-mode loopback --no-verbose --passphrase-fd 3 -u "%{_gpg_name}" -so -
 #%__pgp_check_password_cmd	%{__pgp} \
 #	pgp +batchmode=on +verbose=0 "%{_pgp_name}" -sf
 #%__pgp5_check_password_cmd	%{__pgp} \
diff -ruN rpm-5.4.15.orig/macros/macros.in rpm-5.4.15/macros/macros.in
--- rpm-5.4.15.orig/macros/macros.in	2014-08-09 00:40:40.000000000 +0200
+++ rpm-5.4.15/macros/macros.in	2018-09-24 15:46:34.807097580 +0200
@@ -519,7 +519,7 @@
 #	signing and verification.
 #
 %__gpg_check_password_cmd	%{__gpg} \
-	gpg --batch --no-verbose --passphrase-fd 3 -u "%{_gpg_name}" -so -
+	gpg --batch --pinentry-mode loopback --no-verbose --passphrase-fd 3 -u "%{_gpg_name}" -so -
 #%__pgp_check_password_cmd	%{__pgp} \
 #	pgp +batchmode=on +verbose=0 "%{_pgp_name}" -sf
 #%__pgp5_check_password_cmd	%{__pgp} \
