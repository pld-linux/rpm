diff -urN rpm-4.3.org/macros.in rpm-4.3/macros.in
--- rpm-4.3.org/macros.in	2004-05-31 17:16:23.251095072 +0200
+++ rpm-4.3/macros.in	2004-05-31 17:35:47.653079064 +0200
@@ -118,15 +118,20 @@
 %debug_package \
 %ifnarch noarch\
 %global __debug_package 1\
-%package debug\
+%package debuginfo\
 Summary: Debug information for package %{name}\
+Summary(pl): Informacje dla debuggera dla pakietu %{name}\
 Group: Development/Debug\
 AutoReqProv: 0\
-%description debug\
+%description debuginfo\
 This package provides debug information for package %{name}.\
 Debug information is useful when developing applications that use this\
 package or when debugging this package.\
-%files debug -f debugfiles.list\
+%description debuginfo -l pl\
+Ten pakiet dostarcza informacje dla debuggera dla pakietu %{name}.\
+Informacje te s± przydatne przy rozwijaniu aplikacji u¿ywaj±cych tego\
+pakietu oraz przy odpluskwianiu samego pakietu.\
+%files debuginfo -f debugfiles.list\
 %defattr(-,root,root)\
 %endif\
 %{nil}
@@ -844,7 +849,7 @@
 %__spec_install_pre	%{___build_pre}
 %__spec_install_body	%{___build_body}
 %__spec_install_post\
-%{?__debug_package:%{__debug_install_post}}\
+%{expand:%%define __sip_%{?_enable_debug_packages} 1}%{?__sip_1:%{?__debug_package:%{__debug_install_post}}}%{expand:%%undefine __sip_%{?_enable_debug_packages}}\
 %{__arch_install_post}\
 %{__os_install_post}\
 %{nil}
@@ -1250,7 +1250,10 @@
 unset DISPLAY ||:\
 %{nil}
 
-%install %{?_enable_debug_packages:%{?buildsubdir:%{debug_package}}}\
+%install \
+%if 0%{?_enable_debug_packages}\
+%{?buildsubdir:%{debug_package}}\
+%endif\
 %%install\
 LANG=C\
 export LANG\
@@ -1407,7 +1410,7 @@
     %{?verbose:set -x;} \
     if [ -d "$RPM_BUILD_ROOT" ]; then \
 	echo "Strip executable binaries, archives and shared object files."; \
-	filelist=`find $RPM_BUILD_ROOT -type f ! -regex ".*ld-[0-9.]*so.*" %{?_noautostrip:! -regex "%{_noautostrip}"}`; \
+	filelist=`find $RPM_BUILD_ROOT -type f ! -regex ".*ld-[0-9.]*so.*" ! -regex ".*/usr/lib[0-9]*/debug/.*\.debug" %{?_noautostrip:! -regex "%{_noautostrip}"}`; \
 	elfexelist=`echo $filelist | xargs -r file | \
 		awk '/ELF.*executable/ {print $1}' | cut -d: -f1`; \
 	elfsharedlist=`echo $filelist | xargs -r file | \
--- rpm-4.4.2/scripts/find-debuginfo.sh.orig	2005-07-14 17:52:31.000000000 +0200
+++ rpm-4.4.2/scripts/find-debuginfo.sh	2005-07-23 13:57:04.542906944 +0200
@@ -25,7 +25,7 @@
 	[ -f "${debugfn}" ] && continue
 
 	echo extracting debug info from $f
-	/usr/lib/rpm/debugedit -b "$RPM_BUILD_DIR" -d /usr/src/debug -l "$SOURCEFILE" "$f"
+	/usr/bin/debugedit -b "$RPM_BUILD_DIR" -d /usr/src/debug -l "$SOURCEFILE" "$f"
 
 	# A binary already copied into /usr/lib/debug doesn't get stripped,
 	# just has its file names collected and adjusted.
@@ -35,10 +35,12 @@
 
 	mkdir -p "${debugdn}"
 	if test -w "$f"; then
-		eu-strip -f "${debugfn}" "$f" || :
+		eu-strip -f "${debugfn}" -o "$f.tmp" "$f" || :
+		rm -f "$f.tmp"
 	else
 		chmod u+w "$f"
-		eu-strip -f "${debugfn}" "$f" || :
+		eu-strip -f "${debugfn}" -o "$f.tmp" "$f" || :
+		rm -f "$f.tmp"
 		chmod u-w "$f"
 	fi
 done
--- rpm-4.3/platform.in.orig	2004-07-28 21:35:25.000000000 +0200
+++ rpm-4.3/platform.in	2004-07-28 21:37:22.000000000 +0200
@@ -60,7 +60,7 @@
 %{nil}
 
 %__spec_install_post\
-    %{?__debug_package:%{__debug_install_post}}\
+    %{expand:%%define __sip_%{?_enable_debug_packages} 1}%{?__sip_1:%{?__debug_package:%{__debug_install_post}}}%{expand:%%undefine __sip_%{?_enable_debug_packages}}\
     %{__arch_install_post}\
     %{__os_install_post}\
 %{nil}
