+---------------------------------------------------------------------------
| Make sure that an %{error:<msg>} macro really stops further
| processing. Else it would be nothing more than a %{warn:<msg>}.
+---------------------------------------------------------------------------
--- rpm-4.4.2/rpmio/macro.c~	2007-03-07 18:50:42.754005171 +0200
+++ rpm-4.4.2/rpmio/macro.c	2007-03-07 18:55:51.040958707 +0200
@@ -1380,7 +1380,7 @@
 	    STREQ("error", f, fn)) {
 		int waserror = 0;
 		if (STREQ("error", f, fn))
-			waserror = 1;
+			waserror = 1, rc = 1;
 		if (g != NULL && g < ge)
 			doOutput(mb, waserror, g, gn);
 		else
