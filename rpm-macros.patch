diff -ur rpm-4.4.7.org/macros.in rpm-4.4.7/macros.in
--- rpm-4.4.7.org/macros.in	2006-09-24 21:29:28.000000000 +0200
+++ rpm-4.4.7/macros.in	2007-01-24 11:20:36.000000000 +0100
@@ -181,7 +181,7 @@
 %endif\
 %{nil}
 
-%_defaultdocdir		%{_usr}/doc
+%_defaultdocdir		%{_usr}/share/doc
 
 #	The path to the gzip executable (legacy, use %{__gzip} instead).
 %_gzipbin		%{__gzip}
@@ -212,10 +212,11 @@
 %_srcrpmdir		%{_topdir}/SRPMS
 
 #	Directory where temporaray files can be created.
-%_tmppath		%{_var}/tmp
+%_tmppath		%(echo "${TMPDIR:-/tmp}")
+%tmpdir			%{_tmppath}
 
 #	Path to top of build area.
-%_topdir		%{_usrsrc}/rpm
+%_topdir		%(echo $HOME)/rpm
 
 #	The path to the unzip executable (legacy, use %{__unzip} instead).
 %_unzipbin		%{__unzip}
@@ -228,7 +229,7 @@
 #	Configurable build root path, same as BuildRoot: in a specfile.
 #	(Note: the configured macro value will override the spec file value).
 #
-%buildroot		%{_tmppath}/%{name}-root
+%buildroot		%{_tmppath}/%{name}-%{version}-root-%(id -u -n)
 
 #	The sub-directory (relative to %{_builddir}) where sources are compiled.
 #	This macro is set after processing %setup, either explicitly from the
@@ -326,8 +327,8 @@
 #		"w9.gzdio"	gzip level 9 (default).
 #		"w9.bzdio"	bzip2 level 9.
 #
-#%_source_payload	w9.gzdio
-#%_binary_payload	w9.gzdio
+%_source_payload	w9.gzdio
+%_binary_payload	w9.lzdio
 
 #	Archive formats to use for source/binary package payloads.
 #		"cpio"		cpio archive (default)
@@ -473,7 +474,7 @@
 
 #
 # Path to magic file used for file classification.
-%_rpmfc_magic_path	%{_usr}/lib/rpm/magic
+%_rpmfc_magic_path	/usr/share/file/magic
 
 #==============================================================================
 # ---- Database configuration macros.
@@ -921,10 +922,10 @@
   export RPM_BUILD_ROOT}\
   %{?_javaclasspath:CLASSPATH=\"%{_javaclasspath}\"\
   export CLASSPATH}\
-  unset PERL_MM_OPT\
+  unset PERL_MM_OPT || :\
   LANG=C\
   export LANG\
-  unset DISPLAY\
+  unset DISPLAY || :\
   \
   %{verbose:set -x}%{!verbose:exec > /dev/null}\
   umask 022\
@@ -1083,7 +1084,7 @@
 %_includedir		%{_prefix}/include
 %_oldincludedir		/usr/include
 %_infodir		%{_prefix}/info
-%_mandir		%{_prefix}/man
+%_mandir		%{_prefix}/share/man
 
 #==============================================================================
 # ---- config.guess platform macros.
@@ -1361,7 +1362,25 @@
 # helpers are also used by @RPMCONFIGDIR@/rpmdeps {--provides|--requires}.
 #%__executable_provides	@RPMCONFIGDIR@/executabledeps.sh --provides
 #%__executable_requires	@RPMCONFIGDIR@/executabledeps.sh --requires
-%__scriptlet_requires	/bin/bash --rpm-requires
+#%__scriptlet_requires	/bin/bash --rpm-requires
+
+# PLD rpm macros
+%_enable_debug_packages 1
+
+#-----------------------------------------------------------------
+# CFLAGS and LDFLAGS used to build
+
+%debuginfocflags	%{expand:%%define __dic_%{?_enable_debug_packages} 1}%{?__dic_1: -gdwarf-2 -g2}%{expand:%%undefine __dic_%{?_enable_debug_packages}}
+# -feliminate-dwarf2-dups disabled until PR ld/3290 is fixed.
+
+%debugcflags	-O0 -g -Wall
+%optldflags	-Wl,--as-needed
+
+# Warning: those macros are overwritten by macros.build,
+#          left here for compatibility
+%rpmcflags	%{?debug:%debugcflags}%{!?debug:%optflags}%{?debuginfocflags}
+%rpmcxxflags	%{rpmcflags}
+%rpmldflags	%{!?no_build_with_as_needed:-Wl,--as-needed}
 
 # \endverbatim
 #*/
